"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
class Vulnerability {
    constructor(data) {
        this.data = data;
    }
    get created() {
        return this.data.createdAt;
    }
    get isDismissed() {
        return !!this.data.dismisser;
    }
    get dismissedBy() {
        return {
            user: {
                login: this.data.dismisser.login,
                name: this.data.dismisser.name
            },
            reason: this.data.dismissReason,
            at: this.data.dismissedAt,
        };
    }
    get severity() {
        return this.data.securityVulnerability.severity;
    }
    get vulnerability() {
        return Object.assign({}, this.data.securityVulnerability);
    }
    get advisory() {
        return Object.assign({}, this.data.securityAdvisory);
    }
    get source() {
        return {
            manifest: this.data.vulnerableManifestFilename,
            version: this.data.vulnerableRequirements,
            path: this.data.vulnerableManifestPath
        };
    }
    get publishedAt() {
        return this.advisory.publishedAt;
    }
    get link() {
        return this.advisory.permalink;
    }
}
exports.default = Vulnerability;
